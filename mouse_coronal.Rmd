# Mouse coronal {#mouse_coronal}

```{r unref-setup, echo=FALSE, results="asis"}
library(rebook)
chapterPreamble(cache = TRUE)
```


This workflow analyzes a mouse coronal brain section dataset measured using the Visium platform. This dataset was publicly released by 10x Genomics.

The workflow follows the same steps as in the main chapters (using the human DLPFC dataset), with adaptations at several points due to differences between the datasets.



## Description of dataset {#mouse_coronal_dataset}

For more details on the dataset, see section X.

Key differences between this dataset and the human DLPFC dataset used in the main chapters include:

- Cells in the mouse brain are smaller than in the human brain, so there are on average more cells per spot in this dataset.

- The mouse brain is much smaller than the human brain, so the Visium capture area (approximately 6.5mm x 6.5mm) spans one hemisphere of the coronal brain section. As a result, the measurements cover several major brain regions, which contain distinct cell types. By contrast, the human DLPFC section spans only a small area of the DLPFC, which contains a much smaller set of distinct cell types. This has implications for the types of analyses we can do in each dataset.



## Load data

Load the dataset from the [STdata](https://github.com/lmweber/STdata) package.

[TO DO: update to use `ExperimentHub`]

```{r load_data, message=FALSE}
library(SingleCellExperiment)
library(STdata)

# load object
spe <- load_data("mouse_coronal")
spe
```


## Plot data

Plot spots in x-y space to check that the object has loaded correctly.

```{r plot_data, message=FALSE, fig.width=4, fig.height=4}
library(spatzli)
library(ggplot2)

# add cluster IDs (to do: update function to remove this)
colData(spe)$cluster_id <- factor(1)

p <- plotClustersSpots(
  spe, 
  x_coord = "x_coord", 
  y_coord = "y_coord", 
  cluster_id = "cluster_id", 
  palette = "black"
)

# remove legend (to do: update function to remove this)
p + 
  theme(legend.position = "none") + 
  ggtitle("Spots in x-y coordinates")
```


