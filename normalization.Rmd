# Normalization {#normalization}


## Background

Details on normalization in single-cell and spatial data.



## Log-transformed normalized counts

Calculate log-transformed normalized counts (abbreviated as "logcounts"), using pool-based size factors and deconvolution to the spot level.

We use normalization methods from `scater` [@McCarthy2017-zd] and `scran` [@Lun2016-dn], which were originally developed for single-cell RNA sequencing data. We make the assumption that these methods can be applied here by treating spots as equivalent to cells.

Since we have only a single sample, there are no blocking factors in the experimental design.

```{r normalization, message=FALSE, fig.height=4}
library(scran)

# quick clustering for pool-based size factors
set.seed(123)
qclus <- quickCluster(spe)
table(qclus)

# calculate size factors and store in object
spe <- computeSumFactors(spe, cluster = qclus)

summary(sizeFactors(spe))
hist(sizeFactors(spe), breaks = 20)

# calculate logcounts (log-transformed normalized counts) and store in object
spe <- logNormCounts(spe)

assayNames(spe)
```


